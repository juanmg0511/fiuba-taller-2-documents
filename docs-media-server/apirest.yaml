openapi: "3.0.0"
info:
  title: Chotuve API Reference
  version: 1.0.0
servers:
  - url: https://fiuba-taller-2-media-server.herokuapp.com/
    description: Media Server
paths:
  /status:
    get:
      summary: Get server health
      tags:
        - health
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Status'
  /ping:
    get:
      summary: Ping server
      tags:
        - health
      responses:
        '200':
          description: OK
          content:
            text/plain:
              schema:
                type: string
                example: "Ping received!"
  /videos:
    get:
      summary: Get videos
      description: This endpoint also offers a q filter to obtain videos with the id passed as parameter
      parameters:
        - in: query
          name: id
          required: false
          schema:
            type: string
          description: video ID that wants to get
      tags:
        - videos
      responses:
        '200':
          description: A paged array of videos
          content:
            application/json:
              schema:
                type: object
                properties:
                  videos:
                    type: array
                    items:
                      $ref: '#/components/schemas/OutputVideo'
    post:
      summary: Add a new video
      tags:
        - videos
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InputVideo'
      responses:
        '201':
          description: Video recently added
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OutputVideo'
        '409':
          description: Conflict
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OutputVideo'

        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OutputVideo'



components:
  schemas:
    Status:
      type: object
      properties:
        code:
          type: number
        message:
          type: string
        data:
          $ref: '#/components/schemas/Health'

    Health:
      type: object
      properties:
        server_status:
          type: string
        database_status:
          type: string

    InputVideo:
      type: object
      properties:
        video_id:
          type: string
        name:
          type: string
        date_created:
          type: string
        size:
          type: string
        type:
          type: string

    OutputVideo:
      type: object
      properties:
        video_id:
          type: string
        name:
          type: string
        dateCreated:
          type: string
        size:
          type: string
        type:
          type: string
        url:
          type: string
        thumb:
          type: string

    Error:
      type: object
      properties:
        error:
          type: string
